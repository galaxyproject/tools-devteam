<macros>
  <token name="@VERSION@">2.2.1</token>
  <xml name="requirements">
    <requirements>
      <requirement type="package" version="2.2.1">cufflinks</requirement>
      <yield />
    </requirements>
  </xml>
  <xml name="stdio">
    <stdio>
        <exit_code range="1:" />
        <exit_code range=":-1" />
        <regex match="Error:" />
        <regex match="Exception:" />
    </stdio>
  </xml>
  <xml name="condition_inputs">
    <!-- DEFAULT : use BAM/SAM files -->
    <conditional name="in_type">
        <param name="set_in_type" type="select" label="Input data type"
            help="CuffNorm supports either CXB (from cuffquant) or SAM/BAM input files. Mixing is not supported. Default: SAM/BAM">
            <option value="BAM">SAM/BAM</option>
            <option value="CXB">Cuffquant (CXB)</option>
        </param>
        <when value="BAM">
            <repeat name="conditions" title="Condition" min="2">
                <param name="name" title="Condition name" type="text" label="Name"/>
                <repeat name="samples" title="Replicate" min="1">
                    <param name="sample" label="Add replicate" type="data" format="sam,bam"/>
                </repeat>
            </repeat>
        </when>
        <when value="CXB">
            <repeat name="conditions" title="Condition" min="2">
                <param name="name" title="Condition name" type="text" label="Name"/>
                <repeat name="samples" title="Replicate" min="1">
                    <param name="sample" label="Add replicate" type="data" format="cxb"/>
                </repeat>
            </repeat>
        </when>
    </conditional>
  </xml>
  <token name="@CONDITION_SAMPLES@">
            #for $condition in $in_type.conditions:
                #set samples = ','.join( [ str( $sample.sample ) for $sample in $condition.samples ] )
                $samples
            #end for
  </token>
  <token name="@CONDITION_LABELS@">
            #set labels = '\'' + '\',\''.join( [ str( $condition.name ) for $condition in $in_type.conditions ] ) + '\''
            --labels $labels
  </token>
  <xml name="cufflinks_gtf_inputs">
    <param format="gtf" name="inputs" type="data" label="GTF file(s) produced by Cufflinks" help="" multiple="true" />
  </xml>
  <token name="@CUFFLINKS_GTF_INPUTS@">
            ## Inputs.
            #for $input_file in $inputs:
                "${input_file}"
            #end for
  </token>
  <token name="@HAS_MULTIPLE_INPUTS@">getattr(inputs, "__len__", [].__len__)() >= 2</token>
</macros>